# Filtro de Fail2Ban para fallos de autenticación en API de Nginx
# Detecta errores 401 Unauthorized y 403 Forbidden en endpoints de autenticación

[Definition]

failregex = ^<HOST> -.*"(GET|POST|PUT|DELETE|PATCH) /api/v1/auth/[^"]*" (401|403) .*$
            ^<HOST> -.*"(GET|POST|PUT|DELETE|PATCH) [^"]*" (401|403) .*$

ignoreregex =

datepattern = {^LN-BEG}%%ExY(?P<_sep>[-/])%%m(?P=_sep)%%d[T ]%%H:%%M:%%S(?:[.,]%%f)?(?:\s*%%z)?
              ^[^\[]*\[({DATE})
              {^LN-BEG}
